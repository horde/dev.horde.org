<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Class Horde_Token_Base</title>

	<link rel="stylesheet" href="resources/style.css?1648332946">

</head>

<body>
<div id="left">
	<div id="menu">
		<a href="index.html" title="Overview"><span>Overview</span></a>


		<div id="groups">
			<h3>Packages</h3>
			<ul>
				<li class="active"><a href="namespace-Token.html">Token</a>
						</li>
			</ul>
		</div>

		<hr>


		<div id="elements">
			<h3>Classes</h3>
			<ul>
				<li><a href="class-Horde_Token.html">Horde_Token</a></li>
				<li class="active"><a href="class-Horde_Token_Base.html">Horde_Token_Base</a></li>
				<li><a href="class-Horde_Token_Exception.html">Horde_Token_Exception</a></li>
				<li><a href="class-Horde_Token_Exception_Expired.html">Horde_Token_Exception_Expired</a></li>
				<li><a href="class-Horde_Token_Exception_Invalid.html">Horde_Token_Exception_Invalid</a></li>
				<li><a href="class-Horde_Token_Exception_Used.html">Horde_Token_Exception_Used</a></li>
				<li><a href="class-Horde_Token_File.html">Horde_Token_File</a></li>
				<li><a href="class-Horde_Token_Null.html">Horde_Token_Null</a></li>
				<li><a href="class-Horde_Token_Sql.html">Horde_Token_Sql</a></li>
				<li><a href="class-Horde_Token_Translation.html">Horde_Token_Translation</a></li>
			</ul>





		</div>
	</div>
</div>

<div id="splitter"></div>

<div id="right">
<div id="rightInner">
	<form id="search">
		<input type="hidden" name="cx" value="">
		<input type="hidden" name="ie" value="UTF-8">
		<input type="text" name="q" class="text" placeholder="Search">
	</form>

	<div id="navigation">
		<ul>
			<li>
				<a href="index.html" title="Overview"><span>Overview</span></a>
			</li>
			<li>
				<a href="package-Token.html" title="Summary of Token"><span>Package</span></a>
			</li>
			<li class="active">
<span>Class</span>			</li>
		</ul>
		<ul>
			<li>
				<a href="tree.html" title="Tree view of classes, interfaces, traits and exceptions"><span>Tree</span></a>
			</li>
		</ul>
		<ul>
		</ul>
	</div>

<div id="content" class="class">
	<h1>Class Horde_Token_Base</h1>


	<div class="description">
	<p>The Horde_Token_Base:: class provides a common abstracted interface for
a token implementation.</p>

<p>Copyright 2010-2012 Horde LLC (http://www.horde.org/)</p>

<p>See the enclosed file COPYING for license information (LGPL). If you
did not receive this file, see http://www.horde.org/licenses/lgpl21.</p>

	</div>



	<div>
		<h4>Direct known subclasses</h4>
			<a href="class-Horde_Token_File.html">Horde_Token_File</a>, 
			<a href="class-Horde_Token_Null.html">Horde_Token_Null</a>, 
			<a href="class-Horde_Token_Sql.html">Horde_Token_Sql</a>
	</div>






	<div class="info">
		<b>Abstract</b><br>
		
		
		<b>Package:</b> Token<br>

				<b>Category:</b>
				Horde
<br>
				<b>Author:</b>
				Max Kalika <a href="&#x6d;&#x61;&#105;&#108;&#x74;&#x6f;&#58;&#109;&#97;&#x78;&#x40;&#104;&#111;r&#x64;&#x65;&#46;&#111;r&#x67;">&#109;&#97;&#x78;&#x40;&#104;&#111;r&#x64;&#x65;&#46;&#111;r&#x67;</a>
<br>
				<b>Author:</b>
				Chuck Hagenbuch <a href="&#109;a&#x69;l&#x74;&#111;&#x3a;&#99;&#x68;&#117;&#x63;&#107;&#x40;&#104;&#x6f;&#114;&#x64;&#101;&#x2e;&#111;&#x72;&#103;">&#99;&#x68;&#117;&#x63;&#107;&#x40;&#104;&#x6f;&#114;&#x64;&#101;&#x2e;&#111;&#x72;&#103;</a>
<br>
		<b>Located at</b> <a href="source-class-Horde_Token_Base.html#2-257" title="Go to source code">Horde/Token/Base.php</a><br>
	</div>



	<table class="summary methods" id="methods">
	<caption>Methods summary</caption>
	<tr data-order="__construct" id="___construct">

		<td class="attributes"><code>
			 public 

			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#___construct">#</a>
		<code><a href="source-class-Horde_Token_Base.html#25-49" title="Go to source code">__construct</a>( <span>array <var>$params</var></span> )</code>

		<div class="description short">
			<p>Constructor.</p>

		</div>

		<div class="description detailed hidden">
			<p>Constructor.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$params</var></dt>
					<dd>&lt;p&gt;Required parameters:
- secret (string): The secret string used for signing tokens.
Optional parameters:
- token_lifetime (integer): The number of seconds after which tokens
                            time out. Negative numbers represent "no
                            timeout". The default is "-1".
- timeout (integer): The period (in seconds) after which an id is purged.
                     DEFAULT: 86400 (24 hours)&lt;/p&gt;
</dd>
				</dl></div>





		</div>
		</div></td>
	</tr>
	<tr data-order="verify" id="_verify">

		<td class="attributes"><code>
			 public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_verify">#</a>
		<code><a href="source-class-Horde_Token_Base.html#51-72" title="Go to source code">verify</a>( <span>string <var>$token</var></span> )</code>

		<div class="description short">
			<p>Checks if the given token has been previously used. First
purges all expired tokens. Then retrieves current tokens for
the given ip address. If the specified token was not found,
adds it.</p>

		</div>

		<div class="description detailed hidden">
			<p>Checks if the given token has been previously used. First
purges all expired tokens. Then retrieves current tokens for
the given ip address. If the specified token was not found,
adds it.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$token</var></dt>
					<dd>The value of the token to check.
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>True if the token has not been used, false otherwise.

				</div>

				<h4>Throws</h4>
				<div class="list">
					<code><a href="class-Horde_Token_Exception.html">Horde_Token_Exception</a></code>
				</div>



		</div>
		</div></td>
	</tr>
	<tr data-order="exists" id="_exists">

		<td class="attributes"><code>
			abstract public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_exists">#</a>
		<code><a href="source-class-Horde_Token_Base.html#74-82" title="Go to source code">exists</a>( <span>string <var>$tokenID</var></span> )</code>

		<div class="description short">
			<p>Does the token exist?</p>

		</div>

		<div class="description detailed hidden">
			<p>Does the token exist?</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$tokenID</var></dt>
					<dd>Token ID.
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>True if the token exists.

				</div>

				<h4>Throws</h4>
				<div class="list">
					<code><a href="class-Horde_Token_Exception.html">Horde_Token_Exception</a></code>
				</div>



		</div>
		</div></td>
	</tr>
	<tr data-order="add" id="_add">

		<td class="attributes"><code>
			abstract public 

			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_add">#</a>
		<code><a href="source-class-Horde_Token_Base.html#84-91" title="Go to source code">add</a>( <span>string <var>$tokenID</var></span> )</code>

		<div class="description short">
			<p>Add a token ID.</p>

		</div>

		<div class="description detailed hidden">
			<p>Add a token ID.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$tokenID</var></dt>
					<dd>Token ID to add.
</dd>
				</dl></div>


				<h4>Throws</h4>
				<div class="list">
					<code><a href="class-Horde_Token_Exception.html">Horde_Token_Exception</a></code>
				</div>



		</div>
		</div></td>
	</tr>
	<tr data-order="purge" id="_purge">

		<td class="attributes"><code>
			abstract public 

			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_purge">#</a>
		<code><a href="source-class-Horde_Token_Base.html#93-98" title="Go to source code">purge</a>( )</code>

		<div class="description short">
			<p>Delete all expired connection IDs.</p>

		</div>

		<div class="description detailed hidden">
			<p>Delete all expired connection IDs.</p>





				<h4>Throws</h4>
				<div class="list">
					<code><a href="class-Horde_Token_Exception.html">Horde_Token_Exception</a></code>
				</div>



		</div>
		</div></td>
	</tr>
	<tr data-order="get" id="_get">

		<td class="attributes"><code>
			 public 

			string
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_get">#</a>
		<code><a href="source-class-Horde_Token_Base.html#100-113" title="Go to source code">get</a>( <span>string <var>$seed</var> = <span class="php-quote">''</span></span> )</code>

		<div class="description short">
			<p>Return a new signed token.</p>

		</div>

		<div class="description detailed hidden">
			<p>Return a new signed token.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$seed</var></dt>
					<dd>A unique ID to be included in the token.
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>string</code><br>The new token.

				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="isValid" id="_isValid">

		<td class="attributes"><code>
			 public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_isValid">#</a>
		<code><a href="source-class-Horde_Token_Base.html#115-143" title="Go to source code">isValid</a>( <span>string <var>$token</var></span>, <span>string <var>$seed</var> = <span class="php-quote">''</span></span>, <span>integer <var>$timeout</var> = <span class="php-keyword1">null</span></span>, <span>boolean <var>$unique</var> = <span class="php-keyword1">false</span></span> )</code>

		<div class="description short">
			<p>Validate a signed token.</p>

		</div>

		<div class="description detailed hidden">
			<p>Validate a signed token.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$token</var></dt>
					<dd>The signed token.
</dd>
					<dt><var>$seed</var></dt>
					<dd>The unique ID of the token.
</dd>
					<dt><var>$timeout</var></dt>
					<dd>&lt;p&gt;Timout of the token in seconds.
                         Values below zero represent no timeout.&lt;/p&gt;
</dd>
					<dt><var>$unique</var></dt>
					<dd>Should validation of the token succeed only once?
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>True if the token was valid.

				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="validate" id="_validate">

		<td class="attributes"><code>
			 public 

			array
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_validate">#</a>
		<code><a href="source-class-Horde_Token_Base.html#145-170" title="Go to source code">validate</a>( <span>string <var>$token</var></span>, <span>string <var>$seed</var> = <span class="php-quote">''</span></span>, <span>integer <var>$timeout</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Is the given token still valid? Throws an exception in case it is not.</p>

		</div>

		<div class="description detailed hidden">
			<p>Is the given token still valid? Throws an exception in case it is not.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$token</var></dt>
					<dd>The signed token.
</dd>
					<dt><var>$seed</var></dt>
					<dd>The unique ID of the token.
</dd>
					<dt><var>$timeout</var></dt>
					<dd>&lt;p&gt;Timout of the token in seconds.
                         Values below zero represent no timeout.&lt;/p&gt;
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>array</code><br>An array of two elements: The nonce and the hash.

				</div>

				<h4>Throws</h4>
				<div class="list">
					<code><a href="class-Horde_Token_Exception.html">Horde_Token_Exception</a></code><br>If the token was invalid.

				</div>



		</div>
		</div></td>
	</tr>
	<tr data-order="validateUnique" id="_validateUnique">

		<td class="attributes"><code>
			 public 

			null
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_validateUnique">#</a>
		<code><a href="source-class-Horde_Token_Base.html#172-193" title="Go to source code">validateUnique</a>( <span>string <var>$token</var></span>, <span>string <var>$seed</var> = <span class="php-quote">''</span></span> )</code>

		<div class="description short">
			<p>Is the given token valid and has never been used before? Throws an
exception otherwise.</p>

		</div>

		<div class="description detailed hidden">
			<p>Is the given token valid and has never been used before? Throws an
exception otherwise.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$token</var></dt>
					<dd>The signed token.
</dd>
					<dt><var>$seed</var></dt>
					<dd>The unique ID of the token.
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>null</code>
				</div>

				<h4>Throws</h4>
				<div class="list">
					<code><a href="class-Horde_Token_Exception.html">Horde_Token_Exception</a></code><br><p>If the token was invalid or has been
                               used before.</p>

				</div>



		</div>
		</div></td>
	</tr>
	<tr data-order="getNonce" id="_getNonce">

		<td class="attributes"><code>
			 public 

			string
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_getNonce">#</a>
		<code><a href="source-class-Horde_Token_Base.html#235-244" title="Go to source code">getNonce</a>( )</code>

		<div class="description short">
			<p>Return a "number used once" (a concatenation of a timestamp and a random
numer).</p>

		</div>

		<div class="description detailed hidden">
			<p>Return a "number used once" (a concatenation of a timestamp and a random
numer).</p>




				<h4>Returns</h4>
				<div class="list">
					<code>string</code><br>A string of 6 bytes.

				</div>




		</div>
		</div></td>
	</tr>
	</table>


















</div>

	<div id="footer">
		 API documentation generated by <a href="http://apigen.org">ApiGen</a>
	</div>
</div>
</div>
<script src="resources/combined.js?721046668"></script>
<script src="elementlist.js?3973000990"></script>
</body>
</html>
