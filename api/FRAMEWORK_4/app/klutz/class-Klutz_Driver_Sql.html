<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Class Klutz_Driver_Sql</title>

	<link rel="stylesheet" href="resources/style.css?1648332946">

</head>

<body>
<div id="left">
	<div id="menu">
		<a href="index.html" title="Overview"><span>Overview</span></a>


		<div id="groups">
			<h3>Packages</h3>
			<ul>
				<li><a href="namespace-Horde.html">Horde<span></span></a>
						<ul>
				<li><a href="namespace-Horde.Block.html">Block</a>
						</li>
							</ul></li>
				<li class="active"><a href="namespace-Klutz.html">Klutz</a>
						</li>
				<li><a href="namespace-None.html">None</a>
						</li>
			</ul>
		</div>

		<hr>


		<div id="elements">
			<h3>Classes</h3>
			<ul>
				<li><a href="class-Klutz.html">Klutz</a></li>
				<li><a href="class-Klutz_Comic.html">Klutz_Comic</a></li>
				<li><a href="class-Klutz_Comic_Bysize.html">Klutz_Comic_Bysize</a></li>
				<li><a href="class-Klutz_Comic_Direct.html">Klutz_Comic_Direct</a></li>
				<li><a href="class-Klutz_Comic_Search.html">Klutz_Comic_Search</a></li>
				<li><a href="class-Klutz_Driver.html">Klutz_Driver</a></li>
				<li><a href="class-Klutz_Driver_File.html">Klutz_Driver_File</a></li>
				<li class="active"><a href="class-Klutz_Driver_Sql.html">Klutz_Driver_Sql</a></li>
				<li><a href="class-Klutz_Image.html">Klutz_Image</a></li>
			</ul>





		</div>
	</div>
</div>

<div id="splitter"></div>

<div id="right">
<div id="rightInner">
	<form id="search">
		<input type="hidden" name="cx" value="">
		<input type="hidden" name="ie" value="UTF-8">
		<input type="text" name="q" class="text" placeholder="Search">
	</form>

	<div id="navigation">
		<ul>
			<li>
				<a href="index.html" title="Overview"><span>Overview</span></a>
			</li>
			<li>
				<a href="package-Klutz.html" title="Summary of Klutz"><span>Package</span></a>
			</li>
			<li class="active">
<span>Class</span>			</li>
		</ul>
		<ul>
			<li>
				<a href="tree.html" title="Tree view of classes, interfaces, traits and exceptions"><span>Tree</span></a>
			</li>
		</ul>
		<ul>
		</ul>
	</div>

<div id="content" class="class">
	<h1>Class Klutz_Driver_Sql</h1>


	<div class="description">
	<p>Klutz Driver implementation for comics as files with SUM info stored
in SQL database.</p>

<p>Required parameters:</p>

<pre><span class="php-quote">'directory'</span>  The main directory the comics are stored in</pre>

	</div>

	<dl class="tree">
		<dd style="padding-left:0px">
			<a href="class-Klutz_Driver.html"><span>Klutz_Driver</span></a>
			
			
			
		</dd>
		<dd style="padding-left:30px">
			<img src="resources/inherit.png" alt="Extended by">
<b><span>Klutz_Driver_Sql</span></b>			
			
			
		</dd>
	</dl>








	<div class="info">
		
		
		
		<b>Package:</b> Klutz<br>

				<b>Author:</b>
				Marcus I. Ryan <a href="&#109;a&#x69;&#108;&#x74;&#111;&#x3a;&#109;&#x61;&#114;&#x63;&#117;s&#x40;&#114;&#x69;&#98;&#x6f;&#102;&#x6c;&#97;&#x76;&#105;&#x6e;&#46;n&#x65;&#116;">&#109;&#x61;&#114;&#x63;&#117;s&#x40;&#114;&#x69;&#98;&#x6f;&#102;&#x6c;&#97;&#x76;&#105;&#x6e;&#46;n&#x65;&#116;</a>
<br>
				<b>Author:</b>
				Florian Steinel <a href="&#x6d;&#x61;&#105;&#108;&#116;&#x6f;&#x3a;&#x66;&#115;&#116;&#101;&#x69;&#x6e;&#x65;&#108;&#64;&#107;&#x6c;&#x75;&#x74;&#122;&#46;h&#x6f;&#x72;&#x64;&#101;&#46;f&#x6c;&#x6f;&#x6e;&#101;&#116;.&#x6e;&#x65;&#116;">&#x66;&#115;&#116;&#101;&#x69;&#x6e;&#x65;&#108;&#64;&#107;&#x6c;&#x75;&#x74;&#122;&#46;h&#x6f;&#x72;&#x64;&#101;&#46;f&#x6c;&#x6f;&#x6e;&#101;&#116;.&#x6e;&#x65;&#116;</a>
<br>
		<b>Located at</b> <a href="source-class-Klutz_Driver_Sql.html#4-466" title="Go to source code">Driver/Sql.php</a><br>
	</div>



	<table class="summary methods" id="methods">
	<caption>Methods summary</caption>
	<tr data-order="Klutz_Driver_sql" id="_Klutz_Driver_sql">

		<td class="attributes"><code>
			 public 

			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_Klutz_Driver_sql">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#39-61" title="Go to source code">Klutz_Driver_sql</a>( <span>array <var>$params</var> = <span class="php-keyword1">array</span>()</span> )</code>

		<div class="description short">
			<p>Constructs a new SQL storage object.</p>

		</div>

		<div class="description detailed hidden">
			<p>Constructs a new SQL storage object.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$params</var></dt>
					<dd>A hash containing connection parameters.
</dd>
				</dl></div>





		</div>
		</div></td>
	</tr>
	<tr data-order="loadSums" id="_loadSums">

		<td class="attributes"><code>
			 public 

			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_loadSums">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#63-71" title="Go to source code">loadSums</a>( )</code>

		<div class="description short">
			<p>We do nothing in this function for the SQL driver since we grab
the info on demand from the database.  We keep the function here,
however to honor our 'interface' since we call this function from
various places in the client code.</p>

		</div>

		<div class="description detailed hidden">
			<p>We do nothing in this function for the SQL driver since we grab
the info on demand from the database.  We keep the function here,
however to honor our 'interface' since we call this function from
various places in the client code.</p>








		</div>
		</div></td>
	</tr>
	<tr data-order="rebuildSums" id="_rebuildSums">

		<td class="attributes"><code>
			 public 

			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_rebuildSums">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#73-106" title="Go to source code">rebuildSums</a>( )</code>

		<div class="description short">
			<p>Rebuild the table of unique identifiers.</p>

		</div>

		<div class="description detailed hidden">
			<p>Rebuild the table of unique identifiers.</p>








		</div>
		</div></td>
	</tr>
	<tr data-order="addSum" id="_addSum">

		<td class="attributes"><code>
			 public 

			boolean|PEAR_Error
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_addSum">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#108-137" title="Go to source code">addSum</a>( <span>string <var>$index</var></span>, <span>timestamp <var>$date</var></span>, <span>string <var>$data</var></span> )</code>

		<div class="description short">
			<p>Add a unique identifier for a given image.</p>

		</div>

		<div class="description detailed hidden">
			<p>Add a unique identifier for a given image.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$index</var></dt>
					<dd>The index for the comic
</dd>
					<dt><var>$date</var></dt>
					<dd>The date of the comic
</dd>
					<dt><var>$data</var></dt>
					<dd>The md5 of the raw (binary) image data
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean|PEAR_Error</code><br>True on success, PEAR_Error on failure.

				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="removeSum" id="_removeSum">

		<td class="attributes"><code>
			 public 

			integer|PEAR_Error
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_removeSum">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#139-183" title="Go to source code">removeSum</a>( <span>string <var>$index</var> = <span class="php-keyword1">null</span></span>, <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Remove the unique identifier for the given comic and/or
date. If both are passed, removes the uid for that comic and
date. If only a comic is passed, removes all uids for that
comic. If only a date is passed removes uids for all comics on
that date. If neither is passed, all uids are wiped out.</p>

		</div>

		<div class="description detailed hidden">
			<p>Remove the unique identifier for the given comic and/or
date. If both are passed, removes the uid for that comic and
date. If only a comic is passed, removes all uids for that
comic. If only a date is passed removes uids for all comics on
that date. If neither is passed, all uids are wiped out.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$index</var></dt>
					<dd>&lt;p&gt;Index for the comic to delete.  If left out all
                        comics will be assumed.&lt;/p&gt;
</dd>
					<dt><var>$date</var></dt>
					<dd>Date to remove. If left out, assumes all dates.
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>integer|PEAR_Error</code><br>number of affected Comics on success, PEAR_Error on failure.

				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="isUnique" id="_isUnique">

		<td class="attributes"><code>
			 public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_isUnique">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#185-218" title="Go to source code">isUnique</a>( <span><code><a href="class-Klutz_Image.html">Klutz_Image</a></code> <var>$image</var></span> )</code>

		<div class="description short">
			<p>Determine if the image passed is a unique image (one we don't already
have).</p>

		</div>

		<div class="description detailed hidden">
			<p>Determine if the image passed is a unique image (one we don't already
have).</p>

<p>This allows for $days = random, etc., but keeps us from getting the same
comic day after day.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$image</var></dt>
					<dd>Raw (binary) image data.
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>True if unique, false otherwise.

				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="listDates" id="_listDates">

		<td class="attributes"><code>
			 public 

			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_listDates">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#220-307" title="Go to source code">listDates</a>( <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span>, <span>timestamp <var>$oldest</var> = <span class="php-keyword1">null</span></span>, <span>timestamp <var>$newest</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Get a list of the dates for which we have comics between
$oldest and $newest. Only returns dates we have at least one
comic for.</p>

		</div>

		<div class="description detailed hidden">
			<p>Get a list of the dates for which we have comics between
$oldest and $newest. Only returns dates we have at least one
comic for.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$date</var></dt>
					<dd>The reference date (default today)
</dd>
					<dt><var>$oldest</var></dt>
					<dd>&lt;p&gt;The earliest possible date to return (default
                          first of the month)&lt;/p&gt;
</dd>
					<dt><var>$newest</var></dt>
					<dd>&lt;p&gt;The latest possible date to return (default
                          last date of the month)&lt;/p&gt;
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br><p>An array of dates in $subdir format between $oldest and
              $newest that we have comics for | PEAR_Error</p>

				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-Klutz_Driver.html#_listDates">Klutz_Driver::listDates()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="imageSize" id="_imageSize">

		<td class="attributes"><code>
			 public 

			string
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_imageSize">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#309-325" title="Go to source code">imageSize</a>( <span>string <var>$index</var></span>, <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Get the image dimensions for the requested image.</p>

		</div>

		<div class="description detailed hidden">
			<p>Get the image dimensions for the requested image.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$index</var></dt>
					<dd>The index of the comic to check
</dd>
					<dt><var>$date</var></dt>
					<dd>The date of the comic to check (default today)
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>string</code><br>Attributes for an <img> tag giving height and width

				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-Klutz_Driver.html#_imageSize">Klutz_Driver::imageSize()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="imageExists" id="_imageExists">

		<td class="attributes"><code>
			 public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_imageExists">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#327-343" title="Go to source code">imageExists</a>( <span>string <var>$index</var></span>, <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Find out if we already have a local copy of this image.</p>

		</div>

		<div class="description detailed hidden">
			<p>Find out if we already have a local copy of this image.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$index</var></dt>
					<dd>The index of the comic to check
</dd>
					<dt><var>$date</var></dt>
					<dd>The date of the comic to check (default today)
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>False in this driver

				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-Klutz_Driver.html#_imageExists">Klutz_Driver::imageExists()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="retrieveImage" id="_retrieveImage">

		<td class="attributes"><code>
			 public 

			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_retrieveImage">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#345-364" title="Go to source code">retrieveImage</a>( <span>string <var>$index</var></span>, <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Retrieve an image from storage. Make sure the image exists
first with imageExists().</p>

		</div>

		<div class="description detailed hidden">
			<p>Retrieve an image from storage. Make sure the image exists
first with imageExists().</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$index</var></dt>
					<dd>The index of the comic to retrieve
</dd>
					<dt><var>$date</var></dt>
					<dd>The date for which we want $comic
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br><p>If the image exists locally, return a Klutz_Image object.
               If it doesn't, return a string with the URL pointing to
               the comic.</p>

				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-Klutz_Driver.html#_retrieveImage">Klutz_Driver::retrieveImage()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="storeImage" id="_storeImage">

		<td class="attributes"><code>
			 public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_storeImage">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#366-407" title="Go to source code">storeImage</a>( <span>string <var>$index</var></span>, <span>string <var>$image</var></span>, <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Store an image for later retrieval.</p>

		</div>

		<div class="description detailed hidden">
			<p>Store an image for later retrieval.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$index</var></dt>
					<dd>The index of the comic to retrieve
</dd>
					<dt><var>$image</var></dt>
					<dd>Raw (binary) image data to store
</dd>
					<dt><var>$date</var></dt>
					<dd>$data  Date to store it under (default today)
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>True on success, false otherwise

				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-Klutz_Driver.html#_storeImage">Klutz_Driver::storeImage()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="removeImage" id="_removeImage">

		<td class="attributes"><code>
			 public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_removeImage">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#409-432" title="Go to source code">removeImage</a>( <span>string <var>$index</var></span>, <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Remove an image from the storage system (including its unique
ID).</p>

		</div>

		<div class="description detailed hidden">
			<p>Remove an image from the storage system (including its unique
ID).</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$index</var></dt>
					<dd>The index of the comic to remove
</dd>
					<dt><var>$date</var></dt>
					<dd>The date of the comic to remove (default today)
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>True on success, else false

				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="removeDate" id="_removeDate">

		<td class="attributes"><code>
			 public 

			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_removeDate">#</a>
		<code><a href="source-class-Klutz_Driver_Sql.html#434-464" title="Go to source code">removeDate</a>( <span>timestamp <var>$date</var> = <span class="php-keyword1">null</span></span> )</code>

		<div class="description short">
			<p>Remove all images from the storage system (including unique
IDs) for a given date.</p>

		</div>

		<div class="description detailed hidden">
			<p>Remove all images from the storage system (including unique
IDs) for a given date.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$date</var></dt>
					<dd>The date to remove comics for (default today)
</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>True on success, else false

				</div>




		</div>
		</div></td>
	</tr>
	</table>

	<table class="summary inherited">
	<caption>Methods inherited from <a href="class-Klutz_Driver.html#methods">Klutz_Driver</a></caption>
	<tr>
		<td><code>
			<a href="class-Klutz_Driver.html#_factory">factory()</a>
		</code></td>
	</tr>
	</table>











	<table class="summary properties" id="properties">
	<caption>Properties summary</caption>
	<tr data-order="basedir" id="$basedir">
		<td class="attributes"><code>
			public  
			string
		</code></td>

		<td class="name">
				<a href="source-class-Klutz_Driver_Sql.html#17-22" title="Go to source code"><var>$basedir</var></a>

			<div class="description short">
				<p>The base directory we store comics in.</p>

			</div>

			<div class="description detailed hidden">
				<p>The base directory we store comics in.</p>


			</div>
		</td>
		<td class="value">
			<div>
				<a href="#$basedir" class="anchor">#</a>
				<code><span class="php-keyword1">null</span></code>
			</div>
		</td>
	</tr>
	<tr data-order="subdir" id="$subdir">
		<td class="attributes"><code>
			public  
			string
		</code></td>

		<td class="name">
				<a href="source-class-Klutz_Driver_Sql.html#24-30" title="Go to source code"><var>$subdir</var></a>

			<div class="description short">
				<p>The format for the various subdirectories.
WARNING: DO NOT CHANGE THIS!</p>

			</div>

			<div class="description detailed hidden">
				<p>The format for the various subdirectories.
WARNING: DO NOT CHANGE THIS!</p>


			</div>
		</td>
		<td class="value">
			<div>
				<a href="#$subdir" class="anchor">#</a>
				<code><span class="php-quote">'Ymd'</span></code>
			</div>
		</td>
	</tr>
	<tr data-order="_db" id="$_db">
		<td class="attributes"><code>
			public  
			mixed
		</code></td>

		<td class="name">
				<a href="source-class-Klutz_Driver_Sql.html#32-37" title="Go to source code"><var>$_db</var></a>

			<div class="description short">
				<p>The MDB2 database object</p>

			</div>

			<div class="description detailed hidden">
				<p>The MDB2 database object</p>


			</div>
		</td>
		<td class="value">
			<div>
				<a href="#$_db" class="anchor">#</a>
				<code><span class="php-keyword1">null</span></code>
			</div>
		</td>
	</tr>
	</table>






</div>

	<div id="footer">
		 API documentation generated by <a href="http://apigen.org">ApiGen</a>
	</div>
</div>
</div>
<script src="resources/combined.js?721046668"></script>
<script src="elementlist.js?12645800"></script>
</body>
</html>
